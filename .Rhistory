dir.x <- "Y:/FRDC_Habitat/tidy data"
df <- read.csv(paste(dir.x, "2021-04_FRDC_BOSS_Habitat._detailed.habitat.csv", sep='/'))
str(Df)
str(df)
dt.dir <- paste(w.dir, "tidy data", sep='/')
# Directories ----
w.dir <- dirname(rstudioapi::getActiveDocumentContext()$path)
p.dir <- paste(w.dir, "plots", sep = '/')
dt.dir <- paste(w.dir, "tidy data", sep='/')
s.dir <- paste(w.dir, "shapefiles", sep='/')
# Study name ----
study<-"2021-04_drop-camera_Habitat_FRDC"
# functions for summarising data on plots----
se <- function(x) sd(x) / sqrt(length(x))
se.min <- function(x) (mean(x)) - se(x)
se.max <- function(x) (mean(x)) + se(x)
# Read in shapefile ----
setwd(s.dir)
dir()
shapefile <- readOGR(spatial.dir, "WA_wgs84")
shapefile_df <- fortify(shapefile)
shapefile <- readOGR(s.dir, "WA_wgs84")
shapefile <- readOGR(s.dir, "WA_wgs84.shp")
shapefile <- readOGR(paste(s.dir, "WA_wgs84.shp", sep='/'))
shapefile_df <- fortify(shapefile)
library(tidyr)
library(dplyr)
library(readr)
library(ggplot2)
library(stringr)
library(googlesheets4)
library(ggmap)
library(rgdal)
library(raster)
library(png)
library("ggspatial")
library("rnaturalearth")
library("rnaturalearthdata")
library(cowplot)
library(scatterpie)
shapefile <- readOGR(paste(s.dir, "WA_wgs84.shp", sep='/'))
shapefile_df <- fortify(shapefile)
# read in maxn
setwd(dt.dir)
dir()
maxn <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% glimpse()
mutate(Macroalgae = broad.Macroalgae) %>%
mutate(Consolidated = broad.Consolidated) %>%
mutate(Seagrasses = broad.Seagrasses) %>%
mutate(Sponges = broad.Sponges) %>%
mutate(Corals = broad.Stony.corals) %>%
mutate(Sand = broad.Unconsolidated) %>%
mutate(Unknown = broad.Unknown) %>%
glimpse()
# read in maxn
setwd(dt.dir)
dir()
maxn <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% glimpse()
# read in maxn
setwd(dt.dir)
dir()
maxn <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") #%>% glimpse()
maxn <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% #glimpse()
mutate(Macroalgae = broad.Macroalgae) %>%
mutate(Consolidated = broad.Consolidated) %>%
mutate(Seagrasses = broad.Seagrasses) %>%
mutate(Sponges = broad.Sponges) %>%
mutate(Corals = broad.Stony.corals) %>%
mutate(Sand = broad.Unconsolidated) %>%
mutate(Unknown = broad.Unknown) %>%
glimpse()
maxn <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% #glimpse()
rename(Macroalgae = broad.Macroalgae) %>%
rename(Consolidated = broad.Consolidated) %>%
rename(Seagrasses = broad.Seagrasses) %>%
rename(Sponges = broad.Sponges) %>%
rename(Corals = broad.Stony.corals) %>%
rename(Sand = broad.Unconsolidated) %>%
rename(Unknown = broad.Unknown) %>%
glimpse()
broad.hab <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% #glimpse()
rename(Macroalgae = broad.Macroalgae) %>%
rename(Consolidated = broad.Consolidated) %>%
rename(Seagrasses = broad.Seagrasses) %>%
rename(Sponges = broad.Sponges) %>%
rename(Corals = broad.Stony.corals) %>%
rename(Sand = broad.Unconsolidated) %>%
rename(Unknown = broad.Unknown) %>%
glimpse()
# descriptive stats
raw.broad.h <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv")
summary(broad.hab)
broad.hab <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% #glimpse()
rename(Macroalgae = broad.Macroalgae) %>%
rename(Consolidated = broad.Consolidated) %>%
rename(Seagrasses = broad.Seagrasses) %>%
rename(Sponges = broad.Sponges) %>%
rename(Corals = broad.Stony.corals) %>%
rename(Sand = broad.Unconsolidated) %>%
rename(Unknown = broad.Unknown) %>%
mutate_at(c('sample', 'site', 'location'), as.factor) %>%
mutate(date = as.Date(date)) %>%
glimpse()
broad.hab <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% glimpse()
broad.hab <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% glimpse()
broad.hab <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% #glimpse()
rename(Macroalgae = broad.Macroalgae) %>%
rename(Consolidated = broad.Consolidated) %>%
rename(Seagrasses = broad.Seagrasses) %>%
rename(Sponges = broad.Sponges) %>%
rename(Corals = broad.Stony.corals) %>%
rename(Sand = broad.Unconsolidated) %>%
rename(Unknown = broad.Unknown) %>%
mutate_at(c('sample', 'site', 'location'), as.factor) %>%
mutate(date = as.Date(date, format = '%d/%m/%y')) %>%
glimpse()
broad.hab <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv") %>% #glimpse()
rename(Macroalgae = broad.Macroalgae) %>%
rename(Consolidated = broad.Consolidated) %>%
rename(Seagrasses = broad.Seagrasses) %>%
rename(Sponges = broad.Sponges) %>%
rename(Corals = broad.Stony.corals) %>%
rename(Sand = broad.Unconsolidated) %>%
rename(Unknown = broad.Unknown) %>%
mutate_at(c('sample', 'site', 'location', 'visibility', 'location'), as.factor) %>%
mutate(date = as.Date(date, format = '%d/%m/%y')) %>%
glimpse()
# descriptive stats
raw.broad.h <- read.csv("2021-04_FRDC_BOSS_Habitat._broad.habitat.csv")
summary(broad.hab)
shapefile_df
#------Spatial Reef % -------
spatial.reef<-ggplot() +
geom_polygon(data = shapefile_df, aes(x = longitude, y = latitude, group = site),color = 'black', fill = 'grey90', size = .2)+
geom_point(data=filter(broad.hab, Macroalgae==0), aes(longitude,latitude,size=Macroalgae),shape=21,colour="dodgerblue4",fill="white",alpha=0.75)+
geom_point(data=filter(broad.hab, Macroalgae>0),aes(longitude,latitude=Macroalgae),shape=21,colour="dodgerblue4",fill="dodgerblue2",alpha=0.75)+
xlab('Longitude')+
ylab('Latitude')+
labs(size = "% cover\Macroalgae")+
#annotate("text",x=193000, y=7606500,label="Total abundance",color="Black",hjust=0,family="TN",cex=3.5,fontface="italic")+
theme_bw()+
theme_collapse+
theme.larger.text+
#coord_fixed(ratio=1,xlim = c(115.0,115.7), ylim = c(-33.7,-33.3))
spatial.reef
theme_collapse<-theme(      ## the commented values are from theme_grey
panel.grid.major=element_line(colour = "white"), ## element_line(colour = "white")
panel.grid.minor=element_line(colour = "white", size = 0.25),
strip.text.x = element_text(size = 4,angle = 0),
strip.text.y = element_text(size = 4),
axis.title.x=element_text(vjust=-0.0, size=10),
axis.title.y=element_text(vjust=0.0,size=10),
axis.text.x=element_text(size=6),
axis.text.y=element_text(size=6),
legend.title = element_text(family="TN",size=6),
legend.text = element_text(family="TN",size=4))
#------Spatial Reef % -------
spatial.reef<-ggplot() +
geom_polygon(data = shapefile_df, aes(x = longitude, y = latitude, group = site),color = 'black', fill = 'grey90', size = .2)+
geom_point(data=filter(broad.hab, Macroalgae==0), aes(longitude,latitude,size=Macroalgae),shape=21,colour="dodgerblue4",fill="white",alpha=0.75)+
geom_point(data=filter(broad.hab, Macroalgae>0),aes(longitude,latitude=Macroalgae),shape=21,colour="dodgerblue4",fill="dodgerblue2",alpha=0.75)+
xlab('Longitude')+
ylab('Latitude')+
labs(size = "% cover\Macroalgae")+
#annotate("text",x=193000, y=7606500,label="Total abundance",color="Black",hjust=0,family="TN",cex=3.5,fontface="italic")+
theme_bw()+
theme_collapse+
theme.larger.text+
#coord_fixed(ratio=1,xlim = c(115.0,115.7), ylim = c(-33.7,-33.3))
spatial.reef
theme.larger.text<-theme(
strip.text.x = element_text(size = 12,angle = 0),
strip.text.y = element_text(size = 12),
axis.title.x=element_text(vjust=-0.0, size=10),
axis.title.y=element_text(vjust=0.0,size=10),
axis.text.x=element_text(size=12),
axis.text.y=element_text(size=12),
legend.title = element_text(family="TN",size=12),
legend.text = element_text(family="TN",size=12))
theme.species<-theme(
strip.text.x = element_text(size = 8,angle = 0),
strip.text.y = element_text(size = 8),
axis.title.x=element_text(vjust=-0.0, size=12),
axis.title.y=element_text(vjust=0.0,size=12),
axis.text.x=element_text(size=8),
axis.text.y=element_text(size=8),
legend.title = element_text(family="TN",size=11),
legend.text = element_text(family="TN",size=11))
#------Spatial Reef % -------
spatial.reef<-ggplot() +
geom_polygon(data = shapefile_df, aes(x = longitude, y = latitude, group = site),color = 'black', fill = 'grey90', size = .2)+
geom_point(data=filter(broad.hab, Macroalgae==0), aes(longitude,latitude,size=Macroalgae),shape=21,colour="dodgerblue4",fill="white",alpha=0.75)+
geom_point(data=filter(broad.hab, Macroalgae>0),aes(longitude,latitude=Macroalgae),shape=21,colour="dodgerblue4",fill="dodgerblue2",alpha=0.75)+
xlab('Longitude')+
ylab('Latitude')+
labs(size = "% cover\Macroalgae")+
#annotate("text",x=193000, y=7606500,label="Total abundance",color="Black",hjust=0,family="TN",cex=3.5,fontface="italic")+
theme_bw()+
theme_collapse+
theme.larger.text+
#coord_fixed(ratio=1,xlim = c(115.0,115.7), ylim = c(-33.7,-33.3))
spatial.reef
#------Spatial Reef % -------
spatial.reef<-ggplot() +
geom_polygon(data = shapefile_df, aes(x = longitude, y = latitude, group = site),color = 'black', fill = 'grey90', size = .2)+
geom_point(data=filter(broad.hab, Macroalgae==0), aes(longitude,latitude,size=Macroalgae),shape=21,colour="dodgerblue4",fill="white",alpha=0.75)+
geom_point(data=filter(broad.hab, Macroalgae>0),aes(longitude,latitude=Macroalgae),shape=21,colour="dodgerblue4",fill="dodgerblue2",alpha=0.75)+
xlab('Longitude')+
ylab('Latitude')
#------Spatial Reef % -------
spatial.reef<-ggplot() +
geom_polygon(data = shapefile_df, aes(x = longitude, y = latitude, group = site),color = 'black', fill = 'grey90', size = .2)+
geom_point(data=filter(broad.hab, Macroalgae==0), aes(longitude,latitude,size=Macroalgae),shape=21,colour="dodgerblue4",fill="white",alpha=0.75)+
geom_point(data=filter(broad.hab, Macroalgae>0),aes(longitude,latitude=Macroalgae),shape=21,colour="dodgerblue4",fill="dodgerblue2",alpha=0.75)+
xlab('Longitude')+
ylab('Latitude')+
#labs(size = "% cover\Macroalgae")+
#annotate("text",x=193000, y=7606500,label="Total abundance",color="Black",hjust=0,family="TN",cex=3.5,fontface="italic")+
theme_bw()+
theme_collapse+
theme.larger.text+
#coord_fixed(ratio=1,xlim = c(115.0,115.7), ylim = c(-33.7,-33.3))
spatial.reef
shapefile_df
#------Spatial Reef % -------
spatial.reef<-ggplot() +
geom_polygon(data = shapefile_df, aes(x = long, y = lat, group = site),color = 'black', fill = 'grey90', size = .2)+
geom_point(data=filter(broad.hab, Macroalgae==0), aes(longitude,latitude,size=Macroalgae),shape=21,colour="dodgerblue4",fill="white",alpha=0.75)+
geom_point(data=filter(broad.hab, Macroalgae>0),aes(longitude,latitude=Macroalgae),shape=21,colour="dodgerblue4",fill="dodgerblue2",alpha=0.75)+
xlab('Longitude')+
ylab('Latitude')+
#labs(size = "% cover\Macroalgae")+
#annotate("text",x=193000, y=7606500,label="Total abundance",color="Black",hjust=0,family="TN",cex=3.5,fontface="italic")+
theme_bw()+
theme_collapse+
theme.larger.text+
#coord_fixed(ratio=1,xlim = c(115.0,115.7), ylim = c(-33.7,-33.3))
spatial.reef
#------Spatial Reef % -------
spatial.reef<-ggplot() +
geom_polygon(data = shapefile_df, aes(x = long, y = lat, group = site),color = 'black', fill = 'grey90', size = .2)+
geom_point(data=filter(broad.hab, Macroalgae==0), aes(longitude,latitude=Macroalgae),shape=21,colour="dodgerblue4",fill="white",alpha=0.75)+
geom_point(data=filter(broad.hab, Macroalgae>0),aes(longitude,latitude=Macroalgae),shape=21,colour="dodgerblue4",fill="dodgerblue2",alpha=0.75)+
xlab('Longitude')+
ylab('Latitude')+
#labs(size = "% cover\Macroalgae")+
#annotate("text",x=193000, y=7606500,label="Total abundance",color="Black",hjust=0,family="TN",cex=3.5,fontface="italic")+
theme_bw()+
theme_collapse+
theme.larger.text+
#coord_fixed(ratio=1,xlim = c(115.0,115.7), ylim = c(-33.7,-33.3))
spatial.reef
head(broad.hab)
str(broad.hab)
hab<-broad.hab%>%
dplyr::select(sample,Macroalgae,Sand)%>%
#dplyr::rename(bioturbated=bedform.bioturbated,none=bedform.none)%>%
#left_join(metadata)%>%
glimpse()
bedforms <- ggplot() +
geom_polygon(data = shapefile_df, aes(x = long, y = lat, group = group),color = 'black', fill = 'grey90', size = .1)+
geom_scatterpie(aes(x=longitude, y=latitude,r=150),
data=hab, cols=c("Macroalgae","Sand"), color="black", alpha=.8,legend_name="Habitat")+
xlab('Longitude')+
ylab('Latitude')+
labs(size = "Relative abundance")+
theme_bw()+
theme_collapse+
theme.larger.text
bedforms
hab<-broad.hab%>%
dplyr::select(sample,Macroalgae,Sand, latitude, longitude)%>%
#dplyr::rename(bioturbated=bedform.bioturbated,none=bedform.none)%>%
#left_join(metadata)%>%
glimpse()
bedforms <- ggplot() +
geom_polygon(data = shapefile_df, aes(x = long, y = lat, group = group),color = 'black', fill = 'grey90', size = .1)+
geom_scatterpie(data=hab, aes(x=longitude, y=latitude,r=150),
data=hab, cols=c("Macroalgae","Sand"), color="black", alpha=.8,legend_name="Habitat")+
xlab('Longitude')+
ylab('Latitude')+
labs(size = "Relative abundance")+
theme_bw()+
theme_collapse+
theme.larger.text
