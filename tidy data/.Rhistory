write.csv(habitat.broad80,file=paste(study,"_broad.habitat.csv",sep = "."), row.names=FALSE)
setwd("//uniwa.uwa.edu.au/userhome/staff1/00104541/Desktop/GitHub/FRDC_Habitat/tidy data")
dir()
habitat.broad <- metadata%>%
left_join(fov,by="sample")%>%
left_join(broad,by="sample")
write.csv(habitat.broad,file=paste(study,"_broad.habitat.csv",sep = "."), row.names=FALSE)
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
broad<-habitat%>%
dplyr::select(-c(morphology,type))%>%
# filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
filter(!broad%in%c("",NA,"Open.Water","Open Water"))%>%
dplyr::mutate(broad=paste("broad",broad,sep = "."))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tidyr::spread(key=broad,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,filename,fieldofview,relief))%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("broad"))%>%
dplyr::select(-Total.Sum)%>%
dplyr::ungroup()%>%
glimpse
broad<-habitat%>%
dplyr::select(-c(morphology,type))%>%
# filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
filter(!broad%in%c("",NA,"Open.Water","Open Water"))%>%
dplyr::mutate(broad=paste("broad",broad,sep = "."))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tidyr::spread(key=broad,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,filename,fieldofview,relief))%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("broad"))%>%
dplyr::select(-Total.Sum)%>%
dplyr::ungroup()%>%
glimpse
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
broad<-habitat%>%
dplyr::select(-c(morphology,type))%>%
# filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
filter(!broad%in%c("",NA,"Open.Water","Open Water"))%>%
dplyr::mutate(broad=paste("broad",broad,sep = "."))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tidyr::spread(key=broad,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,filename,fieldofview,relief))%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("broad"))%>%
dplyr::select(-Total.Sum)%>%
dplyr::ungroup()%>%
glimpse
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
dplyr::ungroup()%>%
glimpse()
broad<-habitat%>%
dplyr::select(-c(morphology,type))%>%
# filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
filter(!broad%in%c("",NA,"Open.Water","Open Water"))%>%
dplyr::mutate(broad=paste("broad",broad,sep = "."))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tidyr::spread(key=broad,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,sample,fieldofview,relief))%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("broad"))%>%
dplyr::select(-Total.Sum)%>%
dplyr::ungroup()%>%
glimpse
broad<-habitat%>%
dplyr::select(-c(morphology,type))%>%
# filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
filter(!broad%in%c("",NA,"Open.Water","Open Water"))%>%
dplyr::mutate(broad=paste("broad",broad,sep = "."))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tidyr::spread(key=broad,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,sample,fieldofview,relief))%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("broad"))%>%
dplyr::select(-Total.Sum)%>%
dplyr::ungroup()%>%
glimpse
broad<-habitat%>%
dplyr::select(-c(morphology,type))%>%
# filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
filter(!broad%in%c("",NA,"Open.Water","Open Water"))%>%
dplyr::mutate(broad=paste("broad",broad,sep = "."))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tidyr::spread(key=broad,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,filename,fieldofview,relief))%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("broad"))%>%
dplyr::select(-Total.Sum)%>%
dplyr::ungroup()%>%
glimpse
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,image.row,image.col,filename,fieldofview,relief))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,image.row,image.col,filename))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,rowid))%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename,image.row,image.col,rowid))%>%
dplyr::mutate(count=1)%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename,image.row,image.col))%>%
dplyr::mutate(count=1)%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename,image.row,image.col))%>%
dplyr::mutate(count=1)%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename,image.row,image.col))%>%
dplyr::mutate(count=1)%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
broad<-habitat%>%
dplyr::select(-c(morphology,type))%>%
# filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
filter(!broad%in%c("",NA,"Open.Water","Open Water"))%>%
dplyr::mutate(broad=paste("broad",broad,sep = "."))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tidyr::spread(key=broad,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col,filename,fieldofview,relief))%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("broad"))%>%
dplyr::select(-Total.Sum)%>%
dplyr::ungroup()%>%
glimpse
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename,image.row,image.col))%>%
dplyr::mutate(count=1)%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
View(habitat)
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad,filename,image.row,image.col))%>%
dplyr::mutate(count=1)%>%
dplyr::ungroup()%>%
dplyr::group_by(sample)%>%
dplyr::summarise_all(funs(sum))%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tibble::rowid_to_column()%>%
tidyr::spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_if(is.numeric,sum,na.rm=TRUE)%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
View(detailed)
# CREATE catami_morphology------
detailed<-habitat%>%
dplyr::select(-c(fieldofview,relief))%>%
dplyr::filter(!morphology%in%c("",NA,"Unknown"))%>%
dplyr::filter(!broad%in%c("",NA,"Unknown","Open.Water","Open Water"))%>%
dplyr::mutate(morphology=paste("detailed",broad,morphology,type,sep = "."))%>%
dplyr::mutate(morphology=str_replace_all(.$morphology, c(".NA"="")))%>%
dplyr::select(-c(broad))%>%
dplyr::mutate(count=1)%>%
dplyr::group_by(sample)%>%
tidyr::spread(key=morphology,value=count,fill=0)%>%
dplyr::select(-c(image.row,image.col))%>%
dplyr::group_by(sample)%>%
dplyr::summarise_if(is.numeric,sum,na.rm=TRUE)%>%
dplyr::mutate(Total.Sum=rowSums(.[,2:(ncol(.))],na.rm = TRUE ))%>%
dplyr::group_by(sample)%>%
dplyr::mutate_each(funs(./Total.Sum*100), matches("detailed"))%>%
dplyr::select(-Total.Sum)%>%
glimpse()
View(detailed)
write.csv(habitat.broad,file=paste(study,"_broad.habitat.csv",sep = "."), row.names=FALSE)
setwd("//uniwa.uwa.edu.au/userhome/staff1/00104541/Desktop/GitHub/FRDC_Habitat/tidy data")
dir()
habitat.detailed <- metadata%>%
left_join(fov,by="sample")%>%
#left_join(relief,by="sample")%>%
left_join(detailed,by="sample")
write.csv(habitat.detailed,file=paste(study,"_detailed.habitat.csv",sep = "."), row.names=FALSE)
